// SPDX-License-Identifier: MIT

pragma solidity ^0.8.16;

import {ERC721} from "@openzeppelin/contracts/token/ERC721/ERC721.sol";
import {Test, console} from "forge-std/Test.sol";
import {Base64} from "@openzeppelin/contracts/utils/Base64.sol";
import {BlockchainLogoNft} from "../../src/BlockchainLogoNft.sol";
import {DeployBlockchainLogoNft} from "../../script/DeployBlockchainLogoNft.s.sol";

contract BlockchainLogoNftIntegrationTest is Test {
    BlockchainLogoNft blockchainLogoNft;

    string public constant BITCOIN_SVG_IMAGE_URI =
        "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPCEtLSBDcmVhdG9yOiBDb3JlbERSQVcgMjAxOSAoNjQtQml0KSAtLT4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHZlcnNpb249IjEuMSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIKdmlld0JveD0iMCAwIDQwOTEuMjcgNDA5MS43MyIKIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIgogeG1sbnM6eG9kbT0iaHR0cDovL3d3dy5jb3JlbC5jb20vY29yZWxkcmF3L29kbS8yMDAzIj4KIDxnIGlkPSJMYXllcl94MDAyMF8xIj4KICA8bWV0YWRhdGEgaWQ9IkNvcmVsQ29ycElEXzBDb3JlbC1MYXllciIvPgogIDxnIGlkPSJfMTQyMTM0NDAyMzMyOCI+CiAgIDxwYXRoIGZpbGw9IiNGNzkzMUEiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTQwMzAuMDYgMjU0MC43N2MtMjczLjI0LDEwOTYuMDEgLTEzODMuMzIsMTc2My4wMiAtMjQ3OS40NiwxNDg5LjcxIC0xMDk1LjY4LC0yNzMuMjQgLTE3NjIuNjksLTEzODMuMzkgLTE0ODkuMzMsLTI0NzkuMzEgMjczLjEyLC0xMDk2LjEzIDEzODMuMiwtMTc2My4xOSAyNDc5LC0xNDg5Ljk1IDEwOTYuMDYsMjczLjI0IDE3NjMuMDMsMTM4My41MSAxNDg5Ljc2LDI0NzkuNTdsMC4wMiAtMC4wMnoiLz4KICAgPHBhdGggZmlsbD0id2hpdGUiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTI5NDcuNzcgMTc1NC4zOGM0MC43MiwtMjcyLjI2IC0xNjYuNTYsLTQxOC42MSAtNDUwLC01MTYuMjRsOTEuOTUgLTM2OC44IC0yMjQuNSAtNTUuOTQgLTg5LjUxIDM1OS4wOWMtNTkuMDIsLTE0LjcyIC0xMTkuNjMsLTI4LjU5IC0xNzkuODcsLTQyLjM0bDkwLjE2IC0zNjEuNDYgLTIyNC4zNiAtNTUuOTQgLTkyIDM2OC42OGMtNDguODQsLTExLjEyIC05Ni44MSwtMjIuMTEgLTE0My4zNSwtMzMuNjlsMC4yNiAtMS4xNiAtMzA5LjU5IC03Ny4zMSAtNTkuNzIgMjM5Ljc4YzAsMCAxNjYuNTYsMzguMTggMTYzLjA1LDQwLjUzIDkwLjkxLDIyLjY5IDEwNy4zNSw4Mi44NyAxMDQuNjIsMTMwLjU3bC0xMDQuNzQgNDIwLjE1YzYuMjYsMS41OSAxNC4zOCwzLjg5IDIzLjM0LDcuNDkgLTcuNDksLTEuODYgLTE1LjQ2LC0zLjg5IC0yMy43MywtNS44N2wtMTQ2LjgxIDU4OC41N2MtMTEuMTEsMjcuNjIgLTM5LjMxLDY5LjA3IC0xMDIuODcsNTMuMzMgMi4yNSwzLjI2IC0xNjMuMTcsLTQwLjcyIC0xNjMuMTcsLTQwLjcybC0xMTEuNDYgMjU2Ljk4IDI5Mi4xNSA3Mi44M2M1NC4zNSwxMy42MyAxMDcuNjEsMjcuODkgMTYwLjA2LDQxLjNsLTkyLjkgMzczLjAzIDIyNC4yNCA1NS45NCA5MiAtMzY5LjA3YzYxLjI2LDE2LjYzIDEyMC43MSwzMS45NyAxNzguOTEsNDYuNDNsLTkxLjY5IDM2Ny4zMyAyMjQuNTEgNTUuOTQgOTIuODkgLTM3Mi4zM2MzODIuODIsNzIuNDUgNjcwLjY3LDQzLjI0IDc5MS44MywtMzAzLjAyIDk3LjYzLC0yNzguNzggLTQuODYsLTQzOS41OCAtMjA2LjI2LC01NDQuNDQgMTQ2LjY5LC0zMy44MyAyNTcuMTgsLTEzMC4zMSAyODYuNjQsLTMyOS42MWwtMC4wNyAtMC4wNXptLTUxMi45MyA3MTkuMjZjLTY5LjM4LDI3OC43OCAtNTM4Ljc2LDEyOC4wOCAtNjkwLjk0LDkwLjI5bDEyMy4yOCAtNDk0LjJjMTUyLjE3LDM3Ljk5IDY0MC4xNywxMTMuMTcgNTY3LjY3LDQwMy45MXptNjkuNDMgLTcyMy4zYy02My4yOSwyNTMuNTggLTQ1My45NiwxMjQuNzUgLTU4MC42OSw5My4xNmwxMTEuNzcgLTQ0OC4yMWMxMjYuNzMsMzEuNTkgNTM0Ljg1LDkwLjU1IDQ2OC45NCwzNTUuMDVsLTAuMDIgMHoiLz4KICA8L2c+CiA8L2c+Cjwvc3ZnPgo=";
    string public constant ETHEREUM_SVG_IMAGE_URI =
        "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPCEtLSBDcmVhdG9yOiBDb3JlbERSQVcgMjAxOSAoNjQtQml0KSAtLT4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHZlcnNpb249IjEuMSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIKdmlld0JveD0iMCAwIDc4NC4zNyAxMjc3LjM5IgogeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiB4bWxuczp4b2RtPSJodHRwOi8vd3d3LmNvcmVsLmNvbS9jb3JlbGRyYXcvb2RtLzIwMDMiPgogPGcgaWQ9IkxheWVyX3gwMDIwXzEiPgogIDxtZXRhZGF0YSBpZD0iQ29yZWxDb3JwSURfMENvcmVsLUxheWVyIi8+CiAgPGcgaWQ9Il8xNDIxMzk0MzQyNDAwIj4KICAgPGc+CiAgICA8cG9seWdvbiBmaWxsPSIjMzQzNDM0IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iMzkyLjA3LDAgMzgzLjUsMjkuMTEgMzgzLjUsODczLjc0IDM5Mi4wNyw4ODIuMjkgNzg0LjEzLDY1MC41NCAiLz4KICAgIDxwb2x5Z29uIGZpbGw9IiM4QzhDOEMiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSIzOTIuMDcsMCAtMCw2NTAuNTQgMzkyLjA3LDg4Mi4yOSAzOTIuMDcsNDcyLjMzICIvPgogICAgPHBvbHlnb24gZmlsbD0iIzNDM0MzQiIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjM5Mi4wNyw5NTYuNTIgMzg3LjI0LDk2Mi40MSAzODcuMjQsMTI2My4yOCAzOTIuMDcsMTI3Ny4zOCA3ODQuMzcsNzI0Ljg5ICIvPgogICAgPHBvbHlnb24gZmlsbD0iIzhDOEM4QyIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjM5Mi4wNywxMjc3LjM4IDM5Mi4wNyw5NTYuNTIgLTAsNzI0Ljg5ICIvPgogICAgPHBvbHlnb24gZmlsbD0iIzE0MTQxNCIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjM5Mi4wNyw4ODIuMjkgNzg0LjEzLDY1MC41NCAzOTIuMDcsNDcyLjMzICIvPgogICAgPHBvbHlnb24gZmlsbD0iIzM5MzkzOSIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjAsNjUwLjU0IDM5Mi4wNyw4ODIuMjkgMzkyLjA3LDQ3Mi4zMyAiLz4KICAgPC9nPgogIDwvZz4KIDwvZz4KPC9zdmc+Cg==";

    string public constant BITCOIN_SVG_URI =
        "data:application/json;base64,eyJuYW1lIjogIkJsb2NrY2hhaW5Mb2dvIE5GVCIsICJkZXNjcmlwdGlvbiI6ICJCbG9ja2NoYWluIGxvZ29zIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogImxvZ28iLCAiY29sb3IiOiAiYmx1ZSJ9XSwgImltYWdlIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhodGJEcHpjR0ZqWlQwaWNISmxjMlZ5ZG1VaUlIZHBaSFJvUFNJeE1EQWxJaUJvWldsbmFIUTlJakV3TUNVaUlIWmxjbk5wYjI0OUlqRXVNU0lLSUNBZ0lITm9ZWEJsTFhKbGJtUmxjbWx1WnowaVoyVnZiV1YwY21salVISmxZMmx6YVc5dUlpQjBaWGgwTFhKbGJtUmxjbWx1WnowaVoyVnZiV1YwY21salVISmxZMmx6YVc5dUlpQnBiV0ZuWlMxeVpXNWtaWEpwYm1jOUltOXdkR2x0YVhwbFVYVmhiR2wwZVNJS0lDQWdJR1pwYkd3dGNuVnNaVDBpWlhabGJtOWtaQ0lnWTJ4cGNDMXlkV3hsUFNKbGRtVnViMlJrSWlCMmFXVjNRbTk0UFNJd0lEQWdOREE1TVM0eU55QTBNRGt4TGpjeklpQjRiV3h1Y3pwNGJHbHVhejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TVRrNU9TOTRiR2x1YXlJS0lDQWdJSGh0Ykc1ek9uaHZaRzA5SW1oMGRIQTZMeTkzZDNjdVkyOXlaV3d1WTI5dEwyTnZjbVZzWkhKaGR5OXZaRzB2TWpBd015SStDaUFnSUNBOFp5QnBaRDBpVEdGNVpYSmZlREF3TWpCZk1TSStDaUFnSUNBZ0lDQWdQRzFsZEdGa1lYUmhJR2xrUFNKRGIzSmxiRU52Y25CSlJGOHdRMjl5Wld3dFRHRjVaWElpSUM4K0NpQWdJQ0FnSUNBZ1BHY2dhV1E5SWw4eE5ESXhNelEwTURJek16STRJajRLSUNBZ0lDQWdJQ0FnSUNBZ1BIQmhkR2dnWm1sc2JEMGlJMFkzT1RNeFFTSWdabWxzYkMxeWRXeGxQU0p1YjI1NlpYSnZJZ29nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdaRDBpVFRRd016QXVNRFlnTWpVME1DNDNOMk10TWpjekxqSTBMREV3T1RZdU1ERWdMVEV6T0RNdU16SXNNVGMyTXk0d01pQXRNalEzT1M0ME5pd3hORGc1TGpjeElDMHhNRGsxTGpZNExDMHlOek11TWpRZ0xURTNOakl1Tmprc0xURXpPRE11TXprZ0xURTBPRGt1TXpNc0xUSTBOemt1TXpFZ01qY3pMakV5TEMweE1EazJMakV6SURFek9ETXVNaXd0TVRjMk15NHhPU0F5TkRjNUxDMHhORGc1TGprMUlERXdPVFl1TURZc01qY3pMakkwSURFM05qTXVNRE1zTVRNNE15NDFNU0F4TkRnNUxqYzJMREkwTnprdU5UZHNNQzR3TWlBdE1DNHdNbm9pSUM4K0NpQWdJQ0FnSUNBZ0lDQWdJRHh3WVhSb0lHWnBiR3c5SW5kb2FYUmxJaUJtYVd4c0xYSjFiR1U5SW01dmJucGxjbThpQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0JrUFNKTk1qazBOeTQzTnlBeE56VTBMak00WXpRd0xqY3lMQzB5TnpJdU1qWWdMVEUyTmk0MU5pd3ROREU0TGpZeElDMDBOVEFzTFRVeE5pNHlOR3c1TVM0NU5TQXRNelk0TGpnZ0xUSXlOQzQxSUMwMU5TNDVOQ0F0T0RrdU5URWdNelU1TGpBNVl5MDFPUzR3TWl3dE1UUXVOeklnTFRFeE9TNDJNeXd0TWpndU5Ua2dMVEUzT1M0NE55d3ROREl1TXpSc09UQXVNVFlnTFRNMk1TNDBOaUF0TWpJMExqTTJJQzAxTlM0NU5DQXRPVElnTXpZNExqWTRZeTAwT0M0NE5Dd3RNVEV1TVRJZ0xUazJMamd4TEMweU1pNHhNU0F0TVRRekxqTTFMQzB6TXk0Mk9Xd3dMakkySUMweExqRTJJQzB6TURrdU5Ua2dMVGMzTGpNeElDMDFPUzQzTWlBeU16a3VOemhqTUN3d0lERTJOaTQxTml3ek9DNHhPQ0F4TmpNdU1EVXNOREF1TlRNZ09UQXVPVEVzTWpJdU5qa2dNVEEzTGpNMUxEZ3lMamczSURFd05DNDJNaXd4TXpBdU5UZHNMVEV3TkM0M05DQTBNakF1TVRWak5pNHlOaXd4TGpVNUlERTBMak00TERNdU9Ea2dNak11TXpRc055NDBPU0F0Tnk0ME9Td3RNUzQ0TmlBdE1UVXVORFlzTFRNdU9Ea2dMVEl6TGpjekxDMDFMamczYkMweE5EWXVPREVnTlRnNExqVTNZeTB4TVM0eE1Td3lOeTQyTWlBdE16a3VNekVzTmprdU1EY2dMVEV3TWk0NE55dzFNeTR6TXlBeUxqSTFMRE11TWpZZ0xURTJNeTR4Tnl3dE5EQXVOeklnTFRFMk15NHhOeXd0TkRBdU56SnNMVEV4TVM0ME5pQXlOVFl1T1RnZ01qa3lMakUxSURjeUxqZ3pZelUwTGpNMUxERXpMall6SURFd055NDJNU3d5Tnk0NE9TQXhOakF1TURZc05ERXVNMnd0T1RJdU9TQXpOek11TURNZ01qSTBMakkwSURVMUxqazBJRGt5SUMwek5qa3VNRGRqTmpFdU1qWXNNVFl1TmpNZ01USXdMamN4TERNeExqazNJREUzT0M0NU1TdzBOaTQwTTJ3dE9URXVOamtnTXpZM0xqTXpJREl5TkM0MU1TQTFOUzQ1TkNBNU1pNDRPU0F0TXpjeUxqTXpZek00TWk0NE1pdzNNaTQwTlNBMk56QXVOamNzTkRNdU1qUWdOemt4TGpnekxDMHpNRE11TURJZ09UY3VOak1zTFRJM09DNDNPQ0F0TkM0NE5pd3RORE01TGpVNElDMHlNRFl1TWpZc0xUVTBOQzQwTkNBeE5EWXVOamtzTFRNekxqZ3pJREkxTnk0eE9Dd3RNVE13TGpNeElESTROaTQyTkN3dE16STVMall4YkMwd0xqQTNJQzB3TGpBMWVtMHROVEV5TGpreklEY3hPUzR5Tm1NdE5qa3VNemdzTWpjNExqYzRJQzAxTXpndU56WXNNVEk0TGpBNElDMDJPVEF1T1RRc09UQXVNamxzTVRJekxqSTRJQzAwT1RRdU1tTXhOVEl1TVRjc016Y3VPVGtnTmpRd0xqRTNMREV4TXk0eE55QTFOamN1Tmpjc05EQXpMamt4ZW0wMk9TNDBNeUF0TnpJekxqTmpMVFl6TGpJNUxESTFNeTQxT0NBdE5EVXpMamsyTERFeU5DNDNOU0F0TlRnd0xqWTVMRGt6TGpFMmJERXhNUzQzTnlBdE5EUTRMakl4WXpFeU5pNDNNeXd6TVM0MU9TQTFNelF1T0RVc09UQXVOVFVnTkRZNExqazBMRE0xTlM0d05Xd3RNQzR3TWlBd2VpSWdMejRLSUNBZ0lDQWdJQ0E4TDJjK0NpQWdJQ0E4TDJjK0Nqd3ZjM1puUGc9PSJ9";

    DeployBlockchainLogoNft deployer;
    address USER = makeAddr("user");

    function setUp() public {
        deployer = new DeployBlockchainLogoNft();
        blockchainLogoNft = deployer.run();
    }

    function testViewTokenURIIntegration() public {
        vm.prank(USER);
        blockchainLogoNft.mintNft();
        console.log(blockchainLogoNft.tokenURI(0));
    }

    // function testMintedTokenUrisMatchIntegration() public {
    //     vm.prank(USER);
    //     blockchainLogoNft.mintNft();
    //     string memory minted = blockchainLogoNft.tokenURI(0);
    //     string memory bitcoinSvgData = string(
    //         abi.encodePacked(
    //             "data:application/json;base64,",
    //             Base64.encode(
    //                 bytes(
    //                     abi.encodePacked(
    //                         '{"name": "',
    //                         "BlockchainLogo NFT",
    //                         '", "description": "Blockchain logos", "attributes": [{"trait_type": "logo", "color": "blue"}], "image":"',
    //                         BITCOIN_SVG_IMAGE_URI,
    //                         '"}'
    //                     )
    //                 )
    //             )
    //         )
    //     );

    //     assert(
    //         keccak256(abi.encodePacked(minted)) ==
    //             keccak256(abi.encodePacked(bitcoinSvgData))
    //     );
    // }

    function testFlipBullishOnFromBitcoinToEthereum() public {
        vm.prank(USER);
        blockchainLogoNft.mintNft();

        vm.prank(USER);
        blockchainLogoNft.flipBullishOn(0);
        // console.log(blockchainLogoNft.tokenURI(0));

        assertEq(
            keccak256(abi.encodePacked(blockchainLogoNft.tokenURI(0))),
            keccak256(abi.encodePacked(BITCOIN_SVG_URI))
        );
    }
}
